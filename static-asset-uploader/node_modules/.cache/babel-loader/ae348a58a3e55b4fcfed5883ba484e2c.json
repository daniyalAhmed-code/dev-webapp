{"ast":null,"code":"// Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport React from'react';// swagger-ui\nimport SwaggerUI from'swagger-ui';import'swagger-ui/dist/swagger-ui.css';// semantic-ui\nimport{Container,Header,Icon}from'semantic-ui-react';// services\nimport{isRegistered,getCognitoUrl}from'services/self';import{updateUsagePlansAndApisList,getApi}from'services/api-catalog';// components\nimport ApisMenu from'components/ApisMenu';import SwaggerLayoutPlugin from'components/SwaggerUiLayout';import PageWithSidebar from'components/PageWithSidebar';import ApiNotSignIn from'componentsNew/ApiNotSignIn/';// state\nimport{store}from'services/state.js';import{observer}from'mobx-react';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default observer(class ApisPage extends React.Component{constructor(){super(...arguments);this.containerRef=/*#__PURE__*/React.createRef();this.hasRoot=false;}componentDidMount(){this.updateApi(true);}componentDidUpdate(){this.updateApi(false);}componentWillUnmount(){this.containerRef=null;}updateApi(isInitial){return getApi(this.props.match.params.apiId||'ANY',true,this.props.match.params.stage,isInitial).then(api=>{if(this.containerRef==null)return;const elem=this.containerRef.current;const isFirstLoad=!this.hasRoot;this.hasRoot=elem!=null;if(api&&elem!=null){const cell={shouldPreauthorizeApiKey:false,preauthorizeApiKey:()=>{cell.shouldPreauthorizeApiKey=true;}};const swaggerUiConfig={domNode:this.containerRef.current,plugins:[SwaggerLayoutPlugin],supportedSubmitMethods:[],spec:api.swagger,onComplete:()=>cell.preauthorizeApiKey()};if(isRegistered()){delete swaggerUiConfig.supportedSubmitMethods;}const uiHandler=SwaggerUI(swaggerUiConfig);cell.preauthorizeApiKey=()=>{if(store.apiKey){uiHandler.preauthorizeApiKey('api_key',store.apiKey);}};if(cell.shouldPreauthorizeApiKey){cell.preauthorizeApiKey();}if(isFirstLoad)return updateUsagePlansAndApisList(true);}});}signIn(){window.location=getCognitoUrl('login');}render(){let errorHeader;let errorBody;if(!store.apiKey){return/*#__PURE__*/_jsx(ApiNotSignIn,{regLink:this.signIn});}if(store.apiList.loaded){if(!store.apiList.apiGateway.length&&!store.apiList.generic.length){errorHeader='No APIs Published';errorBody='Your administrator hasn\\'t added any APIs to your account. Please contact them to publish an API.';}else if(!store.api){errorHeader='No Such API';errorBody='The selected API doesn\\'t exist.';}}return/*#__PURE__*/_jsx(PageWithSidebar,{sidebarContent:/*#__PURE__*/_jsx(ApisMenu,{path:this.props.match,activateFirst:true}),SidebarPusherProps:{className:'swagger-section'},children:/*#__PURE__*/_jsx(\"div\",{className:\"swagger-ui-wrap\",ref:this.containerRef,style:{padding:'0 20px'},children:errorHeader&&errorBody&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(Header,{as:\"h2\",icon:true,textAlign:\"center\",style:{padding:'40px 0px'},children:[/*#__PURE__*/_jsx(Icon,{name:\"warning sign\",circular:true}),/*#__PURE__*/_jsx(Header.Content,{children:errorHeader})]}),/*#__PURE__*/_jsx(Container,{text:true,textAlign:\"justified\",children:/*#__PURE__*/_jsx(\"p\",{children:errorBody})})]})})});}});","map":{"version":3,"sources":["/home/daniyal/Downloads/vap-webapp (1)/vap-webapp/web-content/static-asset-uploader/src/pages/Apis.jsx"],"names":["React","SwaggerUI","Container","Header","Icon","isRegistered","getCognitoUrl","updateUsagePlansAndApisList","getApi","ApisMenu","SwaggerLayoutPlugin","PageWithSidebar","ApiNotSignIn","store","observer","ApisPage","Component","containerRef","createRef","hasRoot","componentDidMount","updateApi","componentDidUpdate","componentWillUnmount","isInitial","props","match","params","apiId","stage","then","api","elem","current","isFirstLoad","cell","shouldPreauthorizeApiKey","preauthorizeApiKey","swaggerUiConfig","domNode","plugins","supportedSubmitMethods","spec","swagger","onComplete","uiHandler","apiKey","signIn","window","location","render","errorHeader","errorBody","apiList","loaded","apiGateway","length","generic","className","padding"],"mappings":"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","sourcesContent":["// Copyright 2018 Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport React from 'react'\n\n// swagger-ui\nimport SwaggerUI from 'swagger-ui'\nimport 'swagger-ui/dist/swagger-ui.css'\n\n// semantic-ui\nimport { Container, Header, Icon } from 'semantic-ui-react'\n\n// services\nimport { isRegistered, getCognitoUrl } from 'services/self'\nimport { updateUsagePlansAndApisList, getApi } from 'services/api-catalog'\n\n// components\nimport ApisMenu from 'components/ApisMenu'\nimport SwaggerLayoutPlugin from 'components/SwaggerUiLayout'\nimport PageWithSidebar from 'components/PageWithSidebar'\nimport ApiNotSignIn from 'componentsNew/ApiNotSignIn/'\n\n// state\nimport { store } from 'services/state.js'\nimport { observer } from 'mobx-react'\n\nexport default observer(class ApisPage extends React.Component {\n  containerRef = React.createRef()\n  hasRoot = false\n\n  componentDidMount () { this.updateApi(true) }\n  componentDidUpdate () { this.updateApi(false) }\n  componentWillUnmount () { this.containerRef = null }\n\n  updateApi (isInitial) {\n    return getApi(this.props.match.params.apiId || 'ANY', true, this.props.match.params.stage, isInitial)\n      .then(api => {\n        if (this.containerRef == null) return\n        const elem = this.containerRef.current\n        const isFirstLoad = !this.hasRoot\n\n        this.hasRoot = elem != null\n        if (api && elem != null) {\n          const cell = {\n            shouldPreauthorizeApiKey: false,\n            preauthorizeApiKey: () => {\n              cell.shouldPreauthorizeApiKey = true\n            }\n          }\n          const swaggerUiConfig = {\n            domNode: this.containerRef.current,\n            plugins: [SwaggerLayoutPlugin],\n            supportedSubmitMethods: [],\n            spec: api.swagger,\n            onComplete: () => cell.preauthorizeApiKey()\n          }\n          if (isRegistered()) {\n            delete swaggerUiConfig.supportedSubmitMethods\n          }\n\n          const uiHandler = SwaggerUI(swaggerUiConfig)\n          cell.preauthorizeApiKey = () => {\n            if (store.apiKey) {\n              uiHandler.preauthorizeApiKey('api_key', store.apiKey)\n            }\n          }\n          if (cell.shouldPreauthorizeApiKey) {\n            cell.preauthorizeApiKey()\n          }\n\n          if (isFirstLoad) return updateUsagePlansAndApisList(true)\n        }\n      })\n  }\n\n  signIn () {\n    window.location = getCognitoUrl('login')\n  }\n\n  render () {\n    let errorHeader\n    let errorBody\n\n    if (!store.apiKey) {\n      return (\n        <ApiNotSignIn regLink={this.signIn} />\n      )\n    }\n\n    if (store.apiList.loaded) {\n      if (!store.apiList.apiGateway.length && !store.apiList.generic.length) {\n        errorHeader = 'No APIs Published'\n        errorBody = 'Your administrator hasn\\'t added any APIs to your account. Please contact them to publish an API.'\n      } else if (!store.api) {\n        errorHeader = 'No Such API'\n        errorBody = 'The selected API doesn\\'t exist.'\n      }\n    }\n\n    return (\n      <PageWithSidebar\n        sidebarContent={<ApisMenu path={this.props.match} activateFirst={true} />}\n        SidebarPusherProps={{ className: 'swagger-section' }}\n      >\n        <div className='swagger-ui-wrap' ref={this.containerRef} style={{ padding: '0 20px' }}>\n          {errorHeader && errorBody && (\n            <>\n              <Header as='h2' icon textAlign='center' style={{ padding: '40px 0px' }}>\n                <Icon name='warning sign' circular />\n                <Header.Content>{errorHeader}</Header.Content>\n              </Header>\n              <Container text textAlign='justified'>\n                <p>{errorBody}</p>\n              </Container>\n            </>\n          )}\n        </div>\n      </PageWithSidebar>\n    )\n  }\n})\n"]},"metadata":{},"sourceType":"module"}